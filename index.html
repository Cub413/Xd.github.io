<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>Mi App - WebView Seguro</title>
<style>
:root{--bg:#061223;--card:#071428;--accent:#38bdf8;--muted:#94a3b8;}
*{box-sizing:border-box}
body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;background:var(--bg);color:#e6eef8;display:flex;flex-direction:column;height:100vh;overflow:hidden}
#startScreen{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:18px;padding:20px}
h1{margin:0;font-size:28px}
button{border:0;border-radius:12px;padding:12px 18px;font-weight:700;cursor:pointer}
.btnPrimary{background:var(--accent);color:#042028;box-shadow:0 8px 18px rgba(56,189,248,0.12)}
.btnGhost{background:transparent;color:var(--accent);border:1px solid rgba(56,189,248,0.12)}
#mainScreen{display:none;flex-direction:column;height:100%}
.topbar{display:flex;align-items:center;justify-content:space-between;padding:12px 14px;background:linear-gradient(0deg, rgba(255,255,255,0.01), rgba(255,255,255,0.01))}
.titleSmall{font-size:16px;color:var(--muted)}
#iframeContainer{flex:1;display:flex;flex-direction:column}
iframe{width:100%;height:100%;border:0;flex:1;background:#000}
#settingsPanel{position:fixed;right:-100%;top:0;height:100%;width:88%;max-width:420px;background:var(--card);box-shadow:-12px 0 30px rgba(0,0,0,0.6);transition:right .28s;z-index:40;padding:16px;overflow:auto}
#settingsPanel.show{right:0}
.section{margin-bottom:14px;border-radius:10px;padding:10px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02))}
.row{display:flex;align-items:center;justify-content:space-between;gap:10px;padding:8px 4px}
.label{font-size:15px}
.muted{color:var(--muted);font-size:13px}
.switch{width:46px;height:26px;background:rgba(255,255,255,0.06);border-radius:20px;position:relative;cursor:pointer}
.switch .dot{position:absolute;width:20px;height:20px;border-radius:50%;background:white;top:3px;left:3px;transition:left .18s}
.switch.on{background:linear-gradient(90deg,#2dd4bf,#38bdf8)}
.switch.on .dot{left:23px;background:#042028}
input[type="range"]{width:46%;min-width:110px}
select,input[type="text"]{background:transparent;border:1px solid rgba(255,255,255,0.04);color:inherit;padding:8px;border-radius:8px}
.smallBtn{padding:8px 10px;border-radius:8px;background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.02);cursor:pointer}
.hidden{display:none}
.modalWrap{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(2,6,23,0.6);z-index:60}
.modal{background:var(--card);padding:18px;border-radius:12px;min-width:280px;max-width:90%}
.hint{font-size:13px;color:var(--muted);margin-top:8px}
@media(max-width:760px){h1{font-size:24px}.topbar{padding:10px}}
</style>
</head>
<body>

<div id="startScreen">
  <h1>Bienvenido</h1>
  <div style="width:100%;max-width:420px">
    <button id="playBtn" class="btnPrimary" style="width:100%">Jugar</button>
    <div style="height:10px"></div>
    <button id="openSettings" class="btnGhost" style="width:100%">Ajustes</button>
  </div>
  <div class="muted">Optimizado para WebView - sin historial</div>
</div>

<div id="mainScreen">
  <div class="topbar">
    <div>
      <div class="titleSmall">Mi App</div>
      <div class="muted" style="font-size:12px">Interfaz embebida</div>
    </div>
    <div style="display:flex;gap:8px">
      <button id="openSettingsTop" class="smallBtn">Ajustes</button>
      <button id="backHome" class="smallBtn">Inicio</button>
    </div>
  </div>

  <div id="iframeContainer">
    <iframe id="contentFrame" sandbox="allow-scripts allow-forms allow-same-origin allow-popups"></iframe>
  </div>
</div>

<div id="settingsPanel" aria-hidden="true">
  <h2 style="margin-top:0">Ajustes</h2>
  <div class="section">
    <div class="row">
      <div>
        <div class="label">Idioma</div>
        <div class="muted">Preferido para la app</div>
      </div>
      <select id="lang">
        <option>Español</option>
        <option>Inglés</option>
        <option>Portugués</option>
      </select>
    </div>
  </div>
  <div style="height:10px"></div>
  <div style="display:flex;gap:8px">
    <button id="closeSettings" class="smallBtn">Cerrar</button>
    <button id="openInstagramBtn" class="smallBtn">Abrir Instagram</button>
  </div>
</div>

<script>
// Bloqueo de Chrome
if(/Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor)){
  document.body.innerHTML = '<div style="display:flex;justify-content:center;align-items:center;height:100vh;font-family:sans-serif;color:#fff;background:#061223;text-align:center;padding:20px"><h2>Esta app no es compatible con Chrome.<br>Abrela en WebView o app nativa.</h2></div>';
  throw new Error("Bloqueado en Chrome");
}

// Elementos
const playBtn = document.getElementById('playBtn');
const startScreen = document.getElementById('startScreen');
const mainScreen = document.getElementById('mainScreen');
const contentFrame = document.getElementById('contentFrame');
const openSettings = document.getElementById('openSettings');
const openSettingsTop = document.getElementById('openSettingsTop');
const settingsPanel = document.getElementById('settingsPanel');
const closeSettings = document.getElementById('closeSettings');
const openInstagramBtn = document.getElementById('openInstagramBtn');

// Inicio / Play
playBtn.addEventListener('click', ()=> {
  startScreen.style.display = 'none';
  mainScreen.style.display = 'flex';
  contentFrame.src = 'https://cub413.github.io/Cubox.github.io/';
});

// Panel ajustes
function showSettings(){ settingsPanel.classList.add('show'); settingsPanel.setAttribute('aria-hidden','false'); }
function hideSettings(){ settingsPanel.classList.remove('show'); settingsPanel.setAttribute('aria-hidden','true'); }
openSettings.addEventListener('click', showSettings);
openSettingsTop.addEventListener('click', showSettings);
closeSettings.addEventListener('click', hideSettings);

// Instagram solo en iframe, sin historial
openInstagramBtn.addEventListener('click', ()=> {
  contentFrame.src = "instagram://app"; // intenta app
  // fallback web dentro de iframe después
  setTimeout(()=> contentFrame.src="https://www.instagram.com/", 1400);
  hideSettings();
});

// Volver a inicio
document.getElementById('backHome').addEventListener('click', ()=> {
  mainScreen.style.display = 'none';
  startScreen.style.display = 'flex';
  contentFrame.src = 'about:blank';
});

// Prevención mínima de scroll
document.addEventListener('touchmove', ()=>{}, {passive:true});
</script>

</body>
</html>
